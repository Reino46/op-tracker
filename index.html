<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One Piece Tracker</title>
    <meta name="theme-color" content="#0b3075">
    <style>
        body {
            background-color: #0b3075;
            color: #fefefe;
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
     .container {
            max-width: 400px;
            width: 100%;
            background-color: #111827;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            text-align: center;
            box-sizing: border-box;
        }
        h1 { color: #f8de3c; font-size: 24px; margin-top: 5px; }
     .countdown { font-size: 20px; color: #c8472c; font-weight: bold; margin: 15px 0; }
        label { display: block; text-align: left; margin-top: 15px; font-size: 14px; color: #ccc;}
        select, input {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            border: none;
            font-size: 16px;
            box-sizing: border-box;
            background-color: #2a3b5c;
            color: white;
        }
     .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        button {
            background-color: #c8472c;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        button:active { background-color: #a03520; }
     .stats {
            background-color: #0b3075;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 14px;
            line-height: 1.8;
            text-align: left;
        }
     .stats strong { color: #f8de3c; font-size: 16px; }
     .progress-container {
            width: 100%;
            background-color: #333;
            border-radius: 10px;
            margin-top: 15px;
            height: 15px;
            overflow: hidden;
        }
     .progress-bar {
            height: 100%;
            background-color: #f8de3c;
            width: 0%;
            transition: width 0.4s ease-in-out;
        }
     .hint { font-size: 12px; color: #aaa; margin-top: 10px; text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <h1>One Piece Tracker</h1>
    <div class="countdown" id="timer">Υπολογισμός χρόνου...</div>

    <label for="arcSelect">Τρέχον Arc:</label>
    <select id="arcSelect" onchange="updateData()">
        <option value="0">Whole Cake Island (Pace) - 39 Επ.</option>
        <option value="1">Reverie (Pace) - 3 Επ.</option>
        <option value="2">Wano (Pace) - 58 Επ.</option>
        <option value="3">Original Anime (Επ. 1022 - 1155)</option>
    </select>

    <label for="epInput">Τρέχον Επεισόδιο στο Arc:</label>
    <div class="controls">
        <button onclick="changeEp(-1)">-</button>
        <input type="number" id="epInput" value="1" min="1" onchange="updateData()" style="width: 55%; text-align: center; font-weight: bold;">
        <button onclick="changeEp(1)">+</button>
    </div>

    <div class="stats">
        <div>Σου έχουν μείνει ΜΟΝΟ: <strong id="remVideos">234</strong></div>
        <div>Ισοδύναμα έχεις ήδη δει: <strong id="eqProgress">779</strong> / 1155</div>
        <div class="hint" id="suggestedPace">Ενδεικτικός ρυθμός: - Επεισόδια / Ημέρα</div>
    </div>

    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>
</div>

<script>
    // Δεδομένα των Arcs με την μαθηματική αντιστοιχία τους
    const arcs = [
        { id: 'wci', limit: 39, eqLimit: 95 },
        { id: 'reverie', limit: 3, eqLimit: 12 },
        { id: 'wano', limit: 58, eqLimit: 135 }, 
        { id: 'original', limit: 134, eqLimit: 134 } 
    ];

    const totalVideos = 234; 
    const baseEq = 779; 

    // Ανάκτηση δεδομένων από τον browser (LocalStorage)
    function loadData() {
        const saved = JSON.parse(localStorage.getItem('onePieceTracker'));
        if (saved) {
            document.getElementById('arcSelect').value = saved.arcIndex;
            document.getElementById('epInput').value = saved.currentEp;
        }
        updateData();
    }

    // Αλλαγή Επεισοδίου από τα Κουμπιά + και -
    function changeEp(step) {
        let current = parseInt(document.getElementById('epInput').value) |

| 1;
        let arcIndex = parseInt(document.getElementById('arcSelect').value);
        let max = arcs[arcIndex].limit;

        current += step;
        if (current < 1) current = 1;
        if (current > max) current = max;

        document.getElementById('epInput').value = current;
        updateData();
    }

    // Κεντρικός Υπολογισμός Δεδομένων
    function updateData() {
        let arcIndex = parseInt(document.getElementById('arcSelect').value);
        let currentEp = parseInt(document.getElementById('epInput').value) |

| 1;
        
        // Ασφάλεια: Να μην ξεπεράσει το όριο των επεισοδίων του arc
        if (currentEp > arcs[arcIndex].limit) {
            currentEp = arcs[arcIndex].limit;
            document.getElementById('epInput').value = currentEp;
        }

        let videosWatched = 0;
        let eqWatched = baseEq;

        // Υπολογισμός προόδου βάσει του επιλεγμένου Arc
        for (let i = 0; i < arcs.length; i++) {
            if (i < arcIndex) {
                videosWatched += arcs[i].limit;
                eqWatched += arcs[i].eqLimit;
            } else if (i === arcIndex) {
                videosWatched += currentEp;
                // Γραμμική Παρεμβολή για τα Ισοδύναμα Επεισόδια (στρογγυλοποίηση προς τα κάτω)
                eqWatched += Math.floor((currentEp / arcs[i].limit) * arcs[i].eqLimit);
            }
        }

        let remVideos = totalVideos - videosWatched;
        
        // Ενημέρωση της Οθόνης
        document.getElementById('remVideos').innerText = remVideos;
        document.getElementById('eqProgress').innerText = eqWatched;
        
        let percent = (eqWatched / 1155) * 100;
        document.getElementById('progressBar').style.width = percent + "%";

        // Αποθήκευση στον Browser
        localStorage.setItem('onePieceTracker', JSON.stringify({
            arcIndex: arcIndex,
            currentEp: currentEp
        }));

        calculatePace(remVideos);
        checkTransition(arcIndex, currentEp);
    }

    // Αντίστροφη Μέτρηση για τις 5 Απριλίου 2026
    const targetDate = new Date("2026-04-05T00:00:00Z").getTime();
    
    function updateTimer() {
        const now = new Date().getTime();
        const distance = targetDate - now;

        if (distance < 0) {
            document.getElementById('timer').innerText = "Το Elbaf Ξεκίνησε!";
            return;
        }

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        document.getElementById('timer').innerText = 
            days + "η " + hours + "ω " + minutes + "λ " + seconds + "δ";
    }

    // Υπολογισμός Ενδεικτικού Ημερήσιου Ρυθμού
    function calculatePace(remVideos) {
        const now = new Date().getTime();
        const distance = targetDate - now;
        const daysLeft = Math.ceil(distance / (1000 * 60 * 60 * 24));
        
        if (daysLeft > 0 && remVideos > 0) {
            let pace = Math.ceil(remVideos / daysLeft);
            document.getElementById('suggestedPace').innerText = "Ενδεικτικός ρυθμός: περίπου " + pace + " επεισόδια / ημέρα";
        } else if (remVideos === 0) {
            document.getElementById('suggestedPace').innerText = "Τα κατάφερες! Είσαι έτοιμη!";
        } else {
            document.getElementById('suggestedPace').innerText = "";
        }
    }

    // Ειδοποίηση Μετάβασης από Pace στο Αυθεντικό
    function checkTransition(arcIndex, currentEp) {
        if (arcIndex === 2 && currentEp === 58) {
            setTimeout(() => {
                alert("Συγχαρητήρια! Έφτασες στο τέλος του Wano στο One Pace. Άλλαξε το 'Τρέχον Arc' στο 'Original Anime' για να συνεχίσεις από το Επεισόδιο 1022!");
            }, 300);
        }
    }

    // Εκκίνηση Ρολογιού και Ανάκτηση Δεδομένων κατά το άνοιγμα
    setInterval(updateTimer, 1000);
    updateTimer();
    window.onload = loadData;
</script>

</body>
</html>
